You will be given a CSV with columns:
TYPE, CATEGORY, SUBCATEGORY, ITEM

Your task is to append three new columns:
- CATEGORY_M     (“mapped category”)
- SUBCATEGORY_M  (“mapped subcategory”)
- ITEM_M         (“mapped item”)

────────────────────────────────────────────────────────
1. GROUPING LOGIC
────────────────────────────────────────────────────────

Mapping happens in three layers:

• CATEGORY_M is produced by comparing CATEGORY values  
  within the same TYPE group.

• SUBCATEGORY_M is produced by comparing SUBCATEGORY values  
  within the same (TYPE + CATEGORY_M) group.

• ITEM_M is produced by comparing ITEM values  
  within the same (TYPE + CATEGORY_M + SUBCATEGORY_M) group.

CATEGORY and SUBCATEGORY must be evaluated **independently of ITEM**.

────────────────────────────────────────────────────────
2. TEXT NORMALISATION RULES
────────────────────────────────────────────────────────

Two values refer to the same concept if they match after applying:

• Case-insensitive comparison  
• Singular vs plural equivalence  
• Word reordering equivalence  
• Hyphens, commas, slashes, ampersands, spacing differences  
• Unicode apostrophe/quote normalisation  
• Parentheses permutations, spacing normalization  
• Cosmetic phrases ignored:
    “FOR THE YEAR”, “NET OF TAX”, “ATTRIBUTABLE TO …”, “UNDER … CONTRACTS”

For ITEM only:
• Treat PROFIT/(LOSS), (LOSS)/PROFIT, and similar Profit/Loss permutations as equivalent.

────────────────────────────────────────────────────────
3. DOMAIN-AWARE FINANCIAL MEANING RULES
────────────────────────────────────────────────────────

Do NOT merge unless the underlying IFRS/GAAP meaning is identical.

Do NOT merge:
• Net profit vs net loss  
• Pre-tax vs post-tax items  
• Operating income vs operating surplus  
• Finance income vs net interest income  
• Other income vs other operating revenue  
• Share of profit of associate vs gain on investment in associate  
• OCI vs comprehensive income vs net income

You SHOULD merge when the meaning is identical except punctuation or minor formatting:
Examples:
• “TOTAL REVENUE & OTHER INCOME”
  = “TOTAL REVENUE AND OTHER INCOME”
• “BASIC AND DILUTED LOSS PER SHARE”
  = “BASIC & DILUTED LOSS PER SHARE”

────────────────────────────────────────────────────────
4. CANONICALISATION RULES
────────────────────────────────────────────────────────

For CATEGORY:
• If CATEGORY is non-empty and appears more than once in the same TYPE group
  (even if spelled identically),
  → CATEGORY_M must be populated for ALL those rows.
• If CATEGORY appears only once, leave CATEGORY_M blank.

For SUBCATEGORY:
• If SUBCATEGORY is non-empty and appears more than once in the same (TYPE + CATEGORY_M) group,
  → SUBCATEGORY_M must be populated for ALL those rows.
• If SUBCATEGORY appears only once, leave SUBCATEGORY_M blank.

For ITEM:
• Build equivalence groups within the same (TYPE + CATEGORY_M + SUBCATEGORY_M) group.
• If ITEM belongs to a group with 2 or more equivalent values → populate ITEM_M
  using the canonical representative.
• If ITEM is the only member of its equivalence group → leave ITEM_M blank.

Canonical representative rule:
• The canonical form is the cleanest, shortest, punctuation-neutral member
  of the group.

────────────────────────────────────────────────────────
5. QUOTING REQUIREMENTS
────────────────────────────────────────────────────────

• Every output field must be wrapped in double quotes.
• Preserve input ordering and formatting.
• Append new columns at the end: CATEGORY_M, SUBCATEGORY_M, ITEM_M.

────────────────────────────────────────────────────────
6. FINAL FILTERING RULE (IMPORTANT)
────────────────────────────────────────────────────────

After computing CATEGORY_M, SUBCATEGORY_M, ITEM_M:

**Return ONLY the rows where at least one of the mapping columns is populated.**

This means:
• Only rows that participated in a merge at ANY level (CATEGORY, SUBCATEGORY, or ITEM)
  appear in the output.

Rows with no merges at any level must be removed from the final CSV.

────────────────────────────────────────────────────────
7. FINAL OUTPUT FORMAT
────────────────────────────────────────────────────────

Return ONLY the final filtered CSV with columns exactly:

TYPE, CATEGORY, SUBCATEGORY, ITEM, CATEGORY_M, SUBCATEGORY_M, ITEM_M

No markdown. No explanation. CSV only.

