You will be given a CSV with columns:
TYPE, CATEGORY, SUBCATEGORY, ITEM

Your task is to append three new columns:
- CATEGORY_M   (“mapped category”)
- SUBCATEGORY_M (“mapped subcategory”)
- ITEM_M       (“mapped item”)

──────────────────────────────────────────────
GENERAL MAPPING PRINCIPLES
──────────────────────────────────────────────

1. Compare values only within the appropriate grouping level:
   • CATEGORY_M     → mapped by comparing CATEGORY values within the same TYPE.
   • SUBCATEGORY_M  → mapped by comparing SUBCATEGORY values within the same (TYPE + CATEGORY_M).
   • ITEM_M         → mapped by comparing ITEM values within the same (TYPE + CATEGORY_M + SUBCATEGORY_M).

2. Text-equivalence rules:
   Treat these as equivalent:
   • Capitalisation differences
   • Singular vs plural
   • Word reordering
   • Punctuation differences (hyphens, commas, slashes, ampersands, parentheses spacing)
   • Cosmetic suffix/prefix phrases, including:
       “FOR THE YEAR”, “NET OF TAX”, “ATTRIBUTABLE TO …”, “UNDER … CONTRACTS”
   • For ITEM only: treat PROFIT/(LOSS), (LOSS)/PROFIT, and similar parenthesis permutations as equivalent

3. Additional domain-aware financial mapping rules:
   • Only merge when the financial meaning is truly identical.
   • Do NOT merge:
       – Pre-tax vs post-tax measures
       – Profit vs loss values
       – Operating income vs operating surplus (for-profit context)
       – Other income vs other operating revenue
       – Finance income vs net interest income
       – Share of profit vs gain on investment (equity method vs disposal gains)
       – OCI vs comprehensive income vs net income
   • Do merge when entries are semantically identical except for punctuation, such as:
       – “TOTAL REVENUE AND OTHER INCOME”
         = “TOTAL REVENUE & OTHER INCOME”
       – “BASIC AND DILUTED LOSS PER SHARE”
         = “BASIC & DILUTED LOSS PER SHARE”

4. Canonicalisation rule:
   Normally, equivalent values would share the same canonical `_M` value.
   BUT the strict rule here is:

   **If any merge occurs in a group, then ALL members of that merged group must have a blank mapping.**

   That is:
   • ITEM_M / CATEGORY_M / SUBCATEGORY_M is only populated when the value has *no other equivalent match*.
   • If the group contains 2+ equivalent entries, ALL `_M` fields for that group remain blank.

   This suppresses the canonical output so the user sees clearly where merges occurred.

5. Future CSVs may contain quoted fields — treat them as normal values.

6. Output requirements:
   • Return the SAME CSV, but with CATEGORY_M, SUBCATEGORY_M, ITEM_M appended as the final columns.
   • All text fields must be wrapped in double quotes.
   • No formatting changes besides adding the three new columns.
   • You may reorder nothing.

7. When asked to display only rows with non-empty mapping fields:
   • Only include rows where at least one of CATEGORY_M, SUBCATEGORY_M, ITEM_M is non-blank.

──────────────────────────────────────────────
YOUR OUTPUT
──────────────────────────────────────────────

Return only the final CSV with columns:
TYPE, CATEGORY, SUBCATEGORY, ITEM, CATEGORY_M, SUBCATEGORY_M, ITEM_M
(all fields in double quotes).


──────────────────────────────────────────────
DATA BELOW
──────────────────────────────────────────────
